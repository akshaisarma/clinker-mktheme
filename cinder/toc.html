{# Figure out how deep we go down the rabbit hole #}
{% if 'toc_levels' in meta %}
  {% set levels = meta.toc_levels|first|int %}
{% elif 'toc_levels' in config.extra %}
  {% set levels = config.extra.toc_levels %}
{% else %}
  {% set levels = 3 %}
{% endif %}
<div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    {% for toc_item in toc %}
        <li class="{% if toc_item.active %}active{% endif %}">
            <a href="{{ toc_item.url }}">{{ toc_item.title }}</a>
            {% if levels >= 2 and toc_item.children|length > 0 %}<ul class="nav">
                {% for toc_item in toc_item.children %}
                    <li class="second-level">
                        <a href="{{ toc_item.url }}">{{ toc_item.title }}</a>
                        {% if levels >= 3 and toc_item.children|length > 0 %}<ul class="nav">
                        {% for toc_item in toc_item.children %}
                            <li class="third-level">
                                <a href="{{ toc_item.url }}">{{ toc_item.title }}</a>
                                {% if levels >= 4 and toc_item.children|length > 0 %}<ul class="nav">
                                {% for toc_item in toc_item.children %}
                                    <li class="fourth-level">
                                        <a href="{{ toc_item.url }}">{{ toc_item.title }}</a>
                                        {% if levels >= 5 and toc_item.children|length > 0 %}<ul class="nav">
                                        {% for toc_item in toc_item.children %}
                                            <li class="fifth-level">
                                                <a href="{{ toc_item.url }}">{{ toc_item.title }}</a>
                                                {% if levels >= 6 and toc_item.children|length > 0 %}<ul class="nav">
                                                {% for toc_item in toc_item.children %}
                                                    <li class="sixth-level">
                                                        <a href="{{ toc_item.url }}">{{ toc_item.title }}</a>
                                                    </li>
                                                {% endfor %}
                                                </ul>{% endif %}
                                            </li>
                                        {% endfor %}
                                        </ul>{% endif %}
                                    </li>
                                {% endfor %}
                                </ul>{% endif %}
                            </li>
                        {% endfor %}
                        </ul>{% endif %}
                    </li>
            {% endfor %}
            </ul>{% endif %}
        </li>
    {% endfor %}
    </ul>
</div>
